<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LFDTT: Guide to the documentation</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">LFDTT
   </div>
   <div id="projectbrief">Lock-Free Dynamic Transactional Transformations</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Guide to the documentation </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="intro_sec"></a>
Preface</h1>
<p>This documentation is presented in doxygen format to view the important components of LFDTT. This instruction guide to using LFDTT as an external library that is able to be included from the C++ boost library is currently not supported. This guide allows parts of the code to be explained separately, simply through objects and functions by building the program.</p>
<p>As it is currently not supported as a library, there are necessary steps before using the LFDTT code along with testing tools that are also provided. This guide will provide the instructions to utilize the LFDTT codebase and tools that it provides. The documentation will also cover the basic implementation of the code so that a user will be able to properly use and implement their code along with the codebase.</p>
<p>Simply begin viewing the documentation through the navigation bar. By clicking on one of the classes, it will present the name of the class/struct along with the file with which it belongs to. They will list the functions and attributes/variables that belong to that reference. By scrolling down, it will explain what the parameters and return values are for each function. Some classes will contain member variables which will also contain a brief description of what they represent.</p>
<h1><a class="anchor" id="installation"></a>
Installation Guide</h1>
<p>The instructions for installing dependices were used in the Ubuntu distribution 18.04.1 for Linux at the time of this documentation (April 2019). It may be different for some operating systems.</p>
<h2><a class="anchor" id="step1"></a>
Install Dependencies</h2>
<p>sudo apt-get install libboost-all-dev libgoogle-perftools-dev libtool m4 automake cmake libtbb-dev libgsl0-dev <br />
 OR <br />
 sudo apt-get install libboost-all-dev <br />
 sudo apt-get install libgoogle-perftools-dev<br />
 sudo apt-get install libtool m4 automake<br />
 sudo apt-get install cmake <br />
 sudo apt-get install libtbb-dev <br />
 sudo apt-get install libgs10-dev<br />
</p>
<h2><a class="anchor" id="step2"></a>
Install GCC</h2>
<p>sudo apt-get update &amp;&amp; \ <br />
 sudo apt-get install build-essential software-properties-common -y &amp;&amp; \ <br />
 sudo add-apt-repository ppa:ubuntu-toolchain-r/test -y &amp;&amp; \ <br />
 sudo apt-get update &amp;&amp; \ <br />
 sudo apt-get install gcc-snapshot -y &amp;&amp; \ <br />
 sudo apt-get update &amp;&amp; \ <br />
 sudo apt-get install gcc-7 g++-7 -y &amp;&amp; \ <br />
 sudo update-alternatives &ndash;install /usr/bin/gcc gcc /usr/bin/gcc-7 60 &ndash;slave /usr/bin/g++ g++ /usr/bin/g++-7 &amp;&amp; \ <br />
 sudo apt-get install gcc-4.8 g++-4.8 -y &amp;&amp; \ <br />
 sudo update-alternatives &ndash;install /usr/bin/gcc gcc /usr/bin/gcc-4.8 60 &ndash;slave /usr/bin/g++ g++ /usr/bin/g++-4.8; <br />
 sudo update-alternatives &ndash;config gcc <br />
 gcc -v <br />
</p>
<h2><a class="anchor" id="step3"></a>
Install PERF (Possibly needed, please check to see if installed already)</h2>
<p>sudo apt-get install libgoogle-perftools-dev <br />
 sudo apt install linux-tools-common gawk <br />
 sudo apt-get install linux-tools-generic <br />
 sudo apt-get install linux-tools-4.13.0-45-generic <br />
 sudo apt-get install linux-cloud-tools-4.13.0-45-generic <br />
</p>
<h2><a class="anchor" id="step4"></a>
Get from Github</h2>
<p>mkdir temp <br />
 cd temp <br />
 git clone <a href="https://github.com/ucfcs/Fall2018-Group42-boost-tlds.git">https://github.com/ucfcs/Fall2018-Group42-boost-tlds.git</a> <br />
 (change "temp" folder name to "trans-dev") <br />
 cd trans-dev <br />
 bash bootstrap.sh <br />
 cd ../trans-compile <br />
 ../trans-dev/configure <br />
</p>
<h2><a class="anchor" id="step5"></a>
MAKE and TEST</h2>
<p>cd trans-compile <br />
 make -j8 <br />
 cd trans-dev/script <br />
 python pqtest.py ../../trans-compile/src/trans <br />
</p>
<h2><a class="anchor" id="step6"></a>
DEBUG</h2>
<p>cd trans-compile <br />
 make -j8 CXXFLAGS='-O0 -g' <br />
 cd src <br />
</p>
<p>gdb &ndash;args ./trans &lt;data-structure&gt; &lt;nthreads&gt; &lt;iterations&gt; &lt;txn-size&gt; &lt;key-range&gt; &lt;percent-insert&gt; &lt;percent-delete&gt; <br />
 OR <br />
 libtool &ndash;mode=execute gdb trans <br />
 OR <br />
 gdb ./trans <br />
</p>
<h1><a class="anchor" id="usage_sec"></a>
How to use LFDTT</h1>
<p>The current LFDTT codebase is applicable toward the implementation of list and map datastructures. Three operations supported are the Find, Insert, and Delete operations. There is a main file in the bench directory provided to showcase how the codebase can be implemented to act on those operations.</p>
<p>To begin, create a new <a class="el" href="classTransactionHandler.html">TransactionHandler</a> object by passing in the number of tests to run, the number of threads to use, the number of transactions per test, and the number of containers per test into the constructor.<br />
</p>
<p>Next, create a new <a class="el" href="classTransactionalContainer.html">TransactionalContainer</a> object and set the mentioned TransactionalHandler class to the transaction inside the container. This is done simply to reference all the method calls in reference to the list.</p>
<h2><a class="anchor" id="function_pointer"></a>
Creating the Function Pointers</h2>
<p>There are prerequisites to using the current implementation of creating function pointers.The function pointers have to be wrapped in a class that has to be created in order to contain information regarding 1) the datastructure list(s) itself noted as TransactionContainer, and 2) the information regarding transactions in order to call transaction based methods noted as _txn. Both of these local variables are set outside of the class to reference them after the transactional execution. Shown below is a quick implementation of how to create function pointers:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;translink/transaction.h&quot;</span></div><div class="line"></div><div class="line"><span class="keyword">class </span>TxnFuncTester</div><div class="line">{</div><div class="line"><span class="keyword">public</span>:</div><div class="line">     <span class="keyword">inline</span> <span class="keyword">static</span> std::vector&lt;TransactionalContainer*&gt; _list;</div><div class="line">     </div><div class="line">     <span class="keyword">inline</span> <span class="keyword">static</span> <a class="code" href="classTransactionHandler.html">TransactionHandler</a>* _txn;</div><div class="line"></div><div class="line">     <span class="keyword">static</span> ReturnCode MyTxnFunction(<a class="code" href="structDesc.html">Desc</a>* desc, std::map&lt;std::string, int&gt;&amp; inputMap){</div><div class="line"><span class="preprocessor">#ifdef DEBUG</span></div><div class="line">         printf(<span class="stringliteral">&quot;Input map &#39;x&#39;: %d\n&quot;</span>, inputMap[<span class="stringliteral">&quot;x&quot;</span>]);</div><div class="line"><span class="preprocessor">#endif</span></div><div class="line">         <span class="keywordtype">int</span> foundValue = 0;</div><div class="line"></div><div class="line">         ReturnCode retCode = TxnFuncTester::_txn-&gt;CallOps(desc, TxnFuncTester::_list[0], INSERT, 1, 1, foundValue);</div><div class="line"><span class="preprocessor">#ifdef DEBUG     </span></div><div class="line">         <span class="keywordflow">if</span> (retCode == OK)</div><div class="line">             printf(<span class="stringliteral">&quot;INSERT SUCCESSFUL\n&quot;</span>);</div><div class="line">         <span class="keywordflow">else</span></div><div class="line">             printf(<span class="stringliteral">&quot;FAILED OR SKIPPED\n&quot;</span>);</div><div class="line"><span class="preprocessor">#endif</span></div><div class="line">         inputMap[<span class="stringliteral">&quot;value&quot;</span>] = 100;</div><div class="line"></div><div class="line">         <span class="keywordflow">return</span> OK;</div><div class="line">     }</div><div class="line">}</div></div><!-- fragment --><h2><a class="anchor" id="operation_Calls"></a>
Calling Operations</h2>
<p>Calling operations are only done within the function pointers. Shown in the <a class="el" href="index.html#function_pointer">Creating the Function Pointers</a> section will provide a a quick implmentation on operation calls. The last argument of CallOps() foundValue is used only in the FIND operation but will need to be included when using the method. See more details regarding Find() in <a class="el" href="index.html#using_Find">Find Operation</a>.</p>
<h2><a class="anchor" id="operation_Execution"></a>
Executing Operations as Transactions</h2>
<p>In order to execute operations, we need to pass in a function pointer that contains the operations to perform on the datastructure list, an input map, and an a reference to the output map. </p><div class="fragment"><div class="line">ExecuteOps(<span class="keyword">const</span> TransactionalFunction txnFunction, std::map&lt;std::string, int&gt;* inputMap, std::map&lt;std::string, int&gt;** outputMap)</div></div><!-- fragment --><p> Once Executeops() is called, it will handle storing the data into the descriptor object which will then call HelpOps() proceeding to call the function pointer inside HelpOps().</p>
<h2><a class="anchor" id="using_Find"></a>
Find Operation</h2>
<p>In order to call Find(), simply pass it in as FIND into the third parameter of CallOps().</p>
<ul>
<li>It returns OK if the key is found and stores the value at the node into the value variable.<br />
</li>
<li>It returns SKIP if another thread may be executing on the node.<br />
</li>
<li>It returns FAIL if the key cannot be found.<br />
</li>
</ul>
<p>The definition of Find() can be found here <a class="el" href="classTransactionalContainer.html">TransactionalContainer</a>.</p>
<h2><a class="anchor" id="using_Insert"></a>
Insert Operation</h2>
<p>In order to call Insert(), simply pass it in as INSERT into the third parameter of CallOps().</p>
<ul>
<li>It returns OK if the key is successfully inserted along with the value.<br />
</li>
<li>It returns SKIP if another thread may be executing on the node.<br />
</li>
<li>It returns FAIL if the key exists and cannot be inserted.<br />
</li>
</ul>
<p>The definition of Insert can be found here <a class="el" href="classTransactionalContainer.html">TransactionalContainer</a>.</p>
<h2><a class="anchor" id="using_Delete"></a>
Delete Operation</h2>
<p>In order to call Delete(), simply pass it in as DELETE into the third parameter of CallOps().</p>
<ul>
<li>It returns OK if the key is successfully deleted.<br />
</li>
<li>It returns SKIP if another thread may be executing on the node.<br />
</li>
<li>It returns FAIL if the key cannot be found and deleted.<br />
</li>
</ul>
<p>The definition of Delete() can be found here <a class="el" href="classTransactionalContainer.html">TransactionalContainer</a>.</p>
<p>This concludes the guide. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
